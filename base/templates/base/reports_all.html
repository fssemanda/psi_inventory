
{% extends 'base.html' %}
{% load static %}
{% load humanize %}

{% block content %}


<div class="container-fluid">
        <div class="row">
            <div class="col-md-8">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="{% url 'homepage'  %}">Home</a></li>
                        <li class="breadcrumb-item" aria-current="page">Reports</li>
                        <li class="breadcrumb-item" aria-current="page">All Assets</li>
                    </ol>
                </nav>
            </div>

        </div>
    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">Assigned Assets</button>
      </li>
      
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button" role="tab" aria-controls="contact" aria-selected="false">Custom Reports</button>
      </li>
    </ul>
    <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">


 <div class="card border-0">
    <div class="card-body border-0">
         <form method = "POST">
             {% csrf_token %}
             <div class="row col-md-12">
                 <div class="form-group col-md-3">

                         <label for="searchName">Asset Engravement Number</label>
                         <input class="form-control" type="search" id="searchName" name="search_name" placeholder="Asset Engravement number" value="{{myvalues.AstNbr}}" id="Username_id"/>

                 </div>
                 <div class="form-group col-md-3">

                         <!-- <label for="searchName">Asset Engravement Number</label> -->

                         <label for="">Asset Type</label>
                         <select class="form-control" name="Asset_Type" id='asset_type_id'>
                           {% for item in myform.Asset_Type %}
                                     {{item}}
                             {% endfor %}
                         </select>


                 </div>
                 <div class="form-group col-md-3">


                         <label for="Project_Name">Project Name</label>
                      <select class="form-control" name="Project_Name" id='project_name_id' placeholder="Project">
                         {% for item in myform.Project_Name %}
                             {{item}}
                         {% endfor %}
                     </select>



                 </div>
                 <div class="form-group col-md-3">

                         <label for="">Condition</label>
                      <select class="form-control" name="Asset_Condition" id='condition_id'>
                         {% for item in myform.Asset_Condition %}
                                 {{item}}
                         {% endfor %}
                     </select>

                 </div>
             </div>
             <div class="row">

                 <div class="form-group col-md-3">
                     <label for="">Status</label>
                      <select class="form-control " name="Asset_Status" id='asset_status'>
                         {% for item in myform.Asset_Status %}
                         {{item}}
                     {% endfor %}
                     </select>
                  </div>

                 <div class="form-group col-md-3">
                     <label for="">Availability</label>
                      <select class="form-control " name="Availability" id='availability_id'>
                         {% for item in myform.Availability%}
                                 {{item}}
                         {% endfor %}
                     </select>
                  </div>
                 <div class="form-group col-md-3">
                     <label for="">Location</label>
                      <select class="form-control " name="Location" id='location_id'>
                         {% for item in myform.Location %}
                                 {{item}}
                         {% endfor %}
                     </select>
                  </div>

                 <div class="form-group col-md-3">
                     <label for="">Supplier/Vendor</label>
                     <input type="text" id="vendor_id" name="vendor" class="form-control"/>
                  </div>
             </div>
             <div class="row">
                 <div class="form-group col-md-3">
                     <label for="mincost">Minimum unit cost</label>
                     <div class="input-group">
                         <input type="number" id="mincost" name="minimum_cost" class="form-control"/>
                     </div>
                 </div>
                 <div class="form-group col-md-3">
                     <label for="maxcost">Maximum unit cost</label>
                     <div class="input-group">
                         <input type="number" id="maxcost" name="maximum_cost" class="form-control" value="{{myvalues.maximum_cost}}"/>
                     </div>
                 </div>
                 <div class="form-group col-md-3">
                     <label for="fromdate">From</label>
                     <div class="input-group">
                         <input type="date" id="fromdate" name="from_date" class="form-control" value="{{myvalues.from_date}}">
                     </div>
                 </div>
                 <div class="form-group col-md-3">
                     <label for="todate">To</label>
                     <div class="input-group">
                         <input type="date" id="todate" name="to_date" class="form-control" value="{{myvalues.to_date}}"/>
                     </div>
                 </div>
                 <div class="form-group col-md-3">
                     <label for="aging">Older than:</label>
                     <div class="input-group">
                         <input type="number" id="aging" name="age class="form-control""/>
                     </div>
                 </div>
             </div>


             <button type="submit" value="" class="btn btn-success btn-md" name="AllAssets">
                 <ion-icon name="search-outline"  class="nav__icon"></ion-icon>
                 <span>
                     Search
                     </span>
                 </button>

                 <button type="submit" value="excel" class="btn btn-secondary btn-md" name="excel">
                     <ion-icon name="download-outline"  class="nav__icon"></ion-icon>
                     <span>
                         Export to Excel
                         </span>
                     </button>

                     <button type="submit" value="pdf" class="btn btn-Danger btn-md" name="pdf">
                         <ion-icon name="download-outline"  class="nav__icon"></ion-icon>
                         <span>
                             Export to PDF
                             </span>
                         </button>


             <!-- <input type="submit" value="PDF" class="btn btn-success btn-md"> -->

         </form>
     </div>
</div>
 <div class="card card-body">
      {% include 'base/validationmessages.html' %}
 </div>
    <div class="card border-0">
        <div class="card-body">

         <div class="original-table">
                         <table id="box" class="table table-hover table table-responsive table-sm">
                 <thead class="thead">
                     <tr>

                         <th scope="row">Engraved Number</th>
                         <th scope="row">Location</th>

                         
                         <th scope="row">Asset Tag Number</th>
                         <th scope="row">Serial</th>
                         <th scope="row">Model Number</th>


                         <th scope="row">Type</th>
                         <th scope="row">Condition</th>
                         <th scope="row">Availability</th>
                         <th scope="row">Status</th>
                         <th scope="row">Purchase Date</th>
                         <th scope="row">Cost (UGX)</th>
                         <th scope="row">Cost (USD)</th>
                         <th scope="row">Donor Project Code</th>
                         <th scope="row">Donor Project</th>
                         <!-- <th scope="row" rowspan="3">Actions</th> -->
     <!--                    <th scope="row">Delete</th>-->
                     </tr>
                 </thead>
                 {% for item in queryObj %}
                     <tr >
                        <td><a href="{% url 'assetdetails' item.Ast_Tag_nbr%}">{{item.Ast_Tag_nbr}}</a></td>
                         <td>{{item.Location}}</td>
                         
                         <td>{{item.AstNo}}</td>
                         <td>{{item.Serial_No}}</td>
                         <td>{{item.Model_No}}</td>


                         <td>{{item.Asset_Type}}</td>
                         <td>{{item.Asset_Condition}}</td>
                         <td>{{item.Availability}}</td>
                         <td>{{item.Asset_Status}}</td>
                         <td>{{item.PurchaseDate}}</td>
                         <td>{{item.Item_Cost_UGX|floatformat:2|intcomma}}</td>
                         <td>{{item.Item_Cost_USD|floatformat:2|intcomma}}</td>
                         <td>{{item.Project}}</td>
                         <td>{{item.Project_Name}}</td>
                         <!-- <td><a class="btn-success btn-sm" href="{% url 'edit_item' item.Ast_Tag_nbr %}">Edit</a></td>
                         <td><a class="btn-success btn-sm" href="{% url 'assign' item.Ast_Tag_nbr %}">Assign</a></td>
                             <td><a class="btn-danger btn-sm" href="{% url 'delete-item' item.Ast_Tag_nbr %}">Delete</a></td> -->



                     </tr>
                       {% endfor %}
             </table>
         </div>
        </div>
    </div>
    </div>
    <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
        <div class="card border-0 text center text-black mb-3">
            <div card-body>

                      <h6 class="card-title mt-3 mb-3">Key Inventory Items summary</h6>
                <div class="row">
                  <div class="col-md-2 no-border">
                      <div class="card card-body no-border psi_greenie">
      
                           <p class="card-subtitle mb-2 card__head">Total Number of Vehicles</p>
                          <p style="font-weight:1000;" class="header__intro"> {{equipObj1}} </p>
                          <p class="card-subtitle mb-2 card__head">Valuation</p>
                          <p style="font-weight:1000;" class="header__intro"> {{equipObj2}} </p>
                      </div>
                  </div>
          <div class="col-md-2 no-border">
              <div class="card card-body no-border blueie">

                  <p class="card-subtitle mb-2 card__head">Servers</p>
                  <p style="font-weight:1000;" class="header__intro"> {{ Desktops|intcomma }}</p>

                  <p class="card-subtitle mb-2 card__head">Valuation</p>
                  <p style="font-weight:1000;" class="header__intro"> {{ Unusable_Desktops|intcomma }}</p>
              </div>
          </div>
          <div class="col-md-2 no-border">
              <div class="card card-body no-border blueie">

                  <p class="card-subtitle mb-2 card__head">Desktops/Laptops</p>
                  <p style="font-weight:1000;" class="header__intro"> {{ Laptops|intcomma }}</p>
                   <p class="card-subtitle mb-2 card__head">Valuation</p>
                  <p style="font-weight:1000;" class="header__intro"> {{ Unusable_Laptops|intcomma }}</p>

              </div>
          </div>
          <div class="col-md-2 no-border">
              <div class="card card-body no-border psi_greenie">

                  <p class="card-subtitle mb-2 card__head" >Tablets:</p>
                  <p style="font-weight:1000;" class="header__intro"> {{ActiveStaff}}</p>
                  <p class="card-subtitle mb-2 card__head" >Valuation</p>
                  <p style="font-weight:1000;" class="header__intro"> {{assignedDevices}}</p>

              </div>
          </div>
          <div class="col-md-2 no-border">
              <div class="card card-body no-border purpie">

                   <p class="card-subtitle mb-2 card__head">Networking Devices (Firewalls, Routers, Switches)</p>
                  <p style="font-weight:1000;" class="header__intro">{{TotalAssigned}}</p>
                  <p class="card-subtitle mb-2 card__head">Valuation</p>
                  <p style="font-weight:1000;" class="header__intro">{{equipObj}}</p>

              </div>
          </div>
                    
                    <div class="col-md-2 no-border">
              <div class="card card-body no-border purpie">

                   <p class="card-subtitle mb-2 card__head">Donor with Most Assets</p>
                  <p style="font-weight:1000;" class="header__intro">{{UserobjFilter}}</p>
                  <p class="card-subtitle mb-2 card__head">Asset Value</p>
                  <p style="font-weight:1000;" class="header__intro">{{dueForDisposalCount}}</p>

              </div>
          </div>
      </div>
                </div>
            </div>
            <div class="row col-12">
              <div class="card col-md-6">
                  <h6 class="card-title">Top Grossing by Asset Type</h6>
                  <div class="card-body">
                      <canvas class="canv2" id="myChart3" width="150" height="70"></canvas>
                  </div>
  <!--                <button type="button" class="btn btn-primary btn-md" id="changebtn2" onclick="Changethis()">Show as Table</button>-->
              </div>
              <div class="card col-md-6 border-0 bg-light">
                  
                  <div class="card-body">
                      <h6 class="card-title">Projects</h6>
                      <table class="table table-md table-stripped">
                          <thead>
                              <th>Engraved Number</th>
                              <th>Tag Number</th>
                              <th>Date of Purchase</th>
                              
                              <th>Supplier</th>
                          </thead>
                          <tbody>
                              {% for FaultyObject in defects %} 
                              <tr>
                                 
                                  <td>{{FaultyObject.Ast_Tag_nbr}}</td>
                                  <td>{{FaultyObject.AstNo}}</td>
                                  <td>{{FaultyObject.PurchaseDate}}</td>
                                  <!-- <td>{{todays_date|add:"25"}}</td> -->
                                  <td>{{FaultyObject.Vendor}}</td>
                              </tr>
                              {% endfor %}
                          </tbody>

                      </table>
                  </div>
              </div>
            </div>
            <div class="row col-12">
              <div class="card col-md-6 border-0 bg-light">
                  <div class="card-body">
                     
                              <h5 class="card-title">Assets Above $5000 (Top 5)</h5>
                              <table class="table table-md table-stripped">
                                  <thead>
                                      <!-- <th>Engraved Number</th> -->
                                      <th>Tag Number</th>
                                      <th>Date of Purchase</th>
                                      
                                      <th>Supplier</th>
                                  </thead>
                                  <tbody>
                                      {% for FaultyObject in performing %} 
                                      <tr>
                                         
                                          <!-- <td>{{FaultyObject.Ast_Tag_nbr}}</td> -->
                                          <td>{{FaultyObject.Ast_Tag_nbr.Model_No}}</td>
                                          <td>{{FaultyObject.Ast_Tag_nbr.PurchaseDate}}</td>
                                          <!-- <td>{{todays_date|add:"25"}}</td> -->
                                          <td>{{FaultyObject.Ast_Tag_nbr.Vendor}}</td>
                                      </tr>
                                      {% endfor %}
                                  </tbody>
      
                              </table>
                          </div>
                      
  <!--                <button type="button" class="btn btn-primary btn-md" id="changebtn2" onclick="Changethis()">Show as Table</button>-->
              </div>
              <div class="card col-md-6 border-0">
                  
                  <div class="card-body">
                      <h5 class="card-title">Assets due for Disposal</h5>
                      <table class="table table-md table-stripped">
                          <thead>
                              <th>Engraved Number</th>
                              <th>Tag Number</th>
                              <th>Date of Purchase</th>
                              
                              <th>Supplier</th>
                          </thead>
                          <tbody>
                              {% for FaultyObject in dueForDisposal %} 
                              <tr>
                                 
                                  <td>{{FaultyObject.Ast_Tag_nbr}}</td>
                                  <td>{{FaultyObject.AstNo}}</td>
                                  <td>{{FaultyObject.PurchaseDate}}</td>
                                  <!-- <td>{{todays_date|add:"25"}}</td> -->
                                  <td>{{FaultyObject.Vendor}}</td>
                              </tr>
                              {% endfor %}
                          </tbody>

                      </table>
                  </div>
              </div>
            </div>
            
<!--          Graph for Aging summary, Assets Below 3 years Below 5years but above 3 years 5 years and above count-->

        </div>
    </div>
</div>



</div>





{% endblock %}
{% block scripts %}
<script>
    $(function() {
        $("#Username_id").autocomplete({
            source: '{% url "getasset" %}'

    });
  } );
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
<script src="{% static 'js/custom.js' %}"></script>
<!--<script src="{% static 'js/analytics.js' %}"></script>-->



{% endblock scripts %}