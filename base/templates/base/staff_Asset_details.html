{% extends "base.html"%}
{% load static %}
{% load humanize %}
{%block content%}    
<div class="topmost-bar-blue bg-info">
</div>
<div class="container-fluid mt-4">
<div class="row">
    <div class="col-md-3">
        <div class="">
            <div class="card mb-3 shadow-lg mb-2 bg-body rounded" >
                
                <div class="card-body align-middle">
                    <h5 class="card-title" id='lblGreetings'>Welcome</h5>
                    <p class="custom-card-header" >{{request.user.staff.Firstname}}</p>
                    <p class="card-text">This is your Device profile. 
                        {{myGroups}}
                    </p>
      
                </div>


            </div>

        </div>
    </div>
    <div class="col-md-3">
        <div class="d-flex justify-content-center">
            <div class="card mb-3 shadow-lg mb-5 bg-body rounded custom-card" >
                
                <div class="card-body">
                    
                    
                   
                        <p class="card-subtitle mb-2 card__head" >Assets in your Posession</p>
                    <p class="custom-card-header"> {{AssignedDevices_count}}
                    <span class="ml-3">
                        
                    </span>
                </p>
            </div>

                


            </div>

        </div>
    </div>
    <div class="col-md-3">
        <div class="d-flex justify-content-center">
            <div class="card mb-3 shadow-lg mb-5 bg-body rounded custom-card" >
                <div class="">
                <div class="card-body">
                    
                    
                   
                        <p class="card-subtitle mb-2 card__head" >Value of Assets in you posession</p>
                    <p class="custom-card-header">USD {{AssignedAssetsValue.value|floatformat:2|intcomma }}
                    <span class="ml-3">
                        <ion-icon name="cash-outline"></ion-icon>
                    </span>
                </p>
            </div>

                </div>


            </div>

        </div>
    </div>
    <div class="col-md-3">
        <div class="col
        ">
            <div class="card shadow-lg mb-5 bg-body rounded" id="serviced">
                <div class="card-header">
                    <h5 class="card-title">Total Assigned Devices</h5>
                </div>
                <div class="card-body">
                    <p class="text-lg">
                    
                   You have {{AssignedDevices_count}} device(s) assigned.
                    </p>
                    <br>
                </div>


            </div>

        </div>
    </div>
</div>
<br>
<div class="row">
    {% include 'base/validationmessages.html' %}
<div class="col-sm-6">
    <div class="card shadow-lg mb-5 bg-body rounded">
        <div class="card-body">
        <h6 class="card-title">Assets in your posession</h6>
        
    
            <table class="table table-sm mt-5 mb-3 p-2 rounded">
                <tr>
                    <th><input type="checkbox" name="Accept"  /></th>
                    <th>Asset-Tag</th>
                    <th>Asset barCode</th>
                    <th>Model</th>
                    <th>Serial No</th>
                    <th>Type</th>
                    <th>Asset Condition</th>

                    {%if request.user.staff.staffrole == "Admin" %}
                    <th>Update</th>
                    {%endif%}
                   
                </tr>
                 {% for i in AssignedDevices %}
                 <tbody class="mytable-output">
                     <tr class="record2">

                        
                        <td><input type="checkbox" name="" id="Checkme" class="check-me"/></td>
                        <td><a  href="{% url 'assetdetails' i.Ast_Tag_nbr%}">{{i.Ast_Tag_nbr}}</a></td>
                        <td>{{i.Ast_Tag_nbr.AstNo}}</td>
                        <td>{{i.Ast_Tag_nbr.Model_No}}</td>
                         <td>{{i.Ast_Tag_nbr.Serial_No}}</td>
                        <td>{{i.Ast_Tag_nbr.Asset_Type}}</td>
                        <td>{{i.Ast_Tag_nbr.Asset_Condition}}</td>
                       
                        {%if request.user.staff.staffrole == "Admin" %}
                            <td>
                                <a class="btn-success btn-sm btn  btn-primary" href="{% url 'assetdetails' i.Ast_Tag_nbr%}">Update</a>
                            </td>

                        {% endif %}
                    </tr>
                </tbody>
                {% endfor %}
            </table>
           <p class="mt-3"> <a class="btn btn-info btn-md text-white" href="{% url 'AssetRQ' %}">Request for Device</a>
                    <a class="btn btn-info btn-md text-white handover" id="handover" href="#">Device hand over</a></p>
                    <a class="btn btn-info btn-md text-white handover" href="{%url 'print-form' staffobj %}">Print User Asset Form</a></p>
        </div>
    </div>
</div>
    <div class="col-sm-6">
        <div class="card shadow-lg mb-5 bg-body rounded" >
           
            <div class="card-body">
                <h6 class='card-title'>
                    Asset Requests
                </h6>
            
            <table class="table table-sm mt-5 mb-3 p-2 rounded">
                <thead class="thead">
                    <tr>
                        <th>Request ID</th>
                        <th>Requested By</th>
                        <th>Device Type</th>
                        <th>Reason</th>
                        <th>Date Requested</th>
                        <th>Approve</th>
                        

                    </tr>
                </thead>
                {%if ApprovalRequests.count < 1 %}
                <tbody class="text-danger text-md">No Data to be displayed</tbody>
                {%else%}
                <tbody>
                {% for i in ApprovalRequests %}
                    <tr>
                        <td>{{i.id}}</td>
                        <td>{{i.Username}}</td>
                        <td>{{i.Device_Type}}</td>
                        <td>{{i.Reason}}</td>
                        <td>{{i.Date_Requested}} </td>
                        <td><a class="btn-success btn-sm" href="{% url 'RQView' i.id %}">View</a></td>
                        {% comment %} <td><a class="btn-danger btn-sm" href="{% url 'reject' i.id %}">Reject</a></td> {% endcomment %}

                    </tr>
                    {% endfor %}
                </tbody>
                        {%endif%}
            </table>
        </div>
        </div>
    </div>
        <div class="row">
            <div class="col-sm-6 col-md-6">
                <div class="card shadow-lg m p-2 bg-body">
                    <div class="card-body">
                        <table class="table table-sm">
                            <thead>
                                <th><input type="checkbox" name="Accept" checked="true" /></th>
                                <th>Request ID</th>
                                <th>Device Assigned</th>
                                <th>Engravement Number</th>
                                <th>Device Number</th>
                                <th>Date Assigned</th>
                                <th>Accept</th>
                                <th>Reject</th>
                            </thead>
                            <tbody>
                                {% for i in AcceptanceObj %}
                                <tr class="lower-table">
                                    <td>{{i.id}}</td>
                                    <td>{{i.Device_Type}}</td>
                                    <td>{{i.Assigned_Device}}</td>
                                    <td>{{i.Assigned_Device.AstNo}}</td>
                                    <td>{{i.Last_Modified}}</td>
                                    <td> <a class="halloha btn btn-info btn-md text-white" href="#" id="Halloha">Accept</a></td>
                                    <td> <a class="btn btn-danger btn-md text-white" href="#">Reject</a></td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

{% endblock %}

{% block scripts %}

<script src="{% static 'js/checks.js' %}"></script>
<script>
    var myDate = new Date();
    var hrs = myDate.getHours();

    var greet;

    if (hrs < 12)
        greet = 'Good Morning,';
    else if (hrs >= 12 && hrs <= 17)
        greet = 'Good Afternoon,';
    else if (hrs >= 17 && hrs <= 24)
        greet = 'Good Evening,';

    document.getElementById('lblGreetings').innerHTML =
        '<b>' + greet + '</b> ';
</script>

    

{% endblock scripts %}