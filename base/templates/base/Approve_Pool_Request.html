{% extends 'base.html' %}


{% block content %}

<div class="container-fluid">
    
    <div>
        {% include 'base/validationmessages.html' %}
    </div>
    <div class="row">
        
        <div class="d-flex col-sm col-md justify-content-center">
            {% if RequestObj.Assigned_Device == None and request.user.staff.staffrole == 'Admin' %}
            <div class="col-md">
                
                    <div class="card border-0">
                        <h4 class="card-title">
                            Available Assets for Assignment ({{pooleddevices.count}})
                        </h4>
                        <div class="card-body p-3">
                            <table id="box" class="table table-hover table table-responsive table-sm">
                                <thead class="thead">
                                    <tr>
                                        <th scope="row">Engraved Number</th>
                                        <th scope="row">Serial</th>
                                        <th scope="row">Model Number</th>
                                        <th scope="row">Type</th>
                                        <th scope="row">Condition</th>
                                        <th scope="row">Availability</th> 
                                        <th scope="row">Location</th>
                                        
                                    </tr>
                                </thead>
                                {% for item in pooleddevices %}
                                    <tr >
                    
                                        <td><a href="{% url 'assetdetails' item.Ast_Tag_nbr %}">{{item.Ast_Tag_nbr}}</a></td>
                                        <td>{{item.Assignment.Username}}</td>
                                        <td>{{item.Model_No}}</td>
                                        <td>{{item.Asset_Type}}</td>
                                        <td>{{item.Asset_Condition}}</td>
                                        <td>{{item.Availability}}</td>
                                        <td>{{item.Location}}</td>
                                       
                                        
                                       
                                        {% comment %} <td><a class="btn-success btn-sm" href="{% url 'poolassignment' item.Ast_Tag_nbr %}">Request</a></td>
                                         {% endcomment %}
                    
                    
                                    </tr>
                                      {% endfor %}
                            </table>
                        </div>
                    
                </div>
            </div>
        </div>
        {% endif %}
        {% comment %} <div class="d-flex col-sm col-md justify-content-center p-3"> {% endcomment %}

            <div class="col-md-6 mr-3 p-3">
                <div>
                    <div class="card border-0 p-3">
                        <h4 class="card-title">
                            Staff Asset Request
                        </h4>
                        <div class="card-body">
                            <div>
                              
                                    <div class="form-row">
                                        <div class="col">
                                            <div class="form-group">
          <form method="POST">
            {% csrf_token %} 

            
            <div class="col-md ">
                <div class="input-group p-2 mb-3 text-center">
                    <div class="input-group-prepend">
                      <span class="input-group-text">Username</span>
                    </div>
                        <input type="text" class="form-control" readonly id="Username_id" name="Username" value="{{RequestObj.Username}}">

                </div>
            </div>
            <div class="col-md">
                <div class="input-group p-2 mb-3 text-center">
                    <div class="input-group-prepend">
                      <span class="input-group-text">Requested Device</span>
                    </div>
                        {{myform.Device_Type}}

                </div>
            </div>
            <div class="col-md">
                <div class="input-group p-2 mb-3 text-center">
                    <div class="input-group-prepend">
                      <span class="input-group-text">Device Number</span>
                    </div>
                    {% if RequestObj.Assigned_Device == None %}
                        {% comment %} <input type="text" class="form-control" id="Ast_tag_nbr_id" name="Ast_tag_nbr" value="{{myform.Assigned_Device}}"> {% endcomment %}
                        {{myform.Assigned_Device}}
                        {% else %}
                        <input type="text" class="form-control" readonly id="Ast_tag_nbr_id" name="Ast_Tag_nbr" placeholder="Type Asset Number" value={{RequestObj.Assigned_Device}}>
                {% endif %}
                </div>
            </div>
            <div class="col-md">
                <div class="input-group p-2 mb-3 text-center">
                    <div class="input-group-prepend">
                      <span class="input-group-text">Reason</span>
                    </div>
                        <input type="text" class="form-control" name='Reason' readonly value="{{RequestObj.Reason}}" >

            </div>
            </div>
            <div class="col-md">
                <div class="input-group p-2 mb-3 text-center">
                    <div class="input-group-prepend">
                      <span class="input-group-text">IT Approval</span>
                    </div>
                    <input type="text" class="form-control" name='AssetManagerApproval' readonly value="{{RequestObj.AssetManagerApproval}}" >
                    {% if  request.user.staff.staffrole == 'Admin' %}
                    
                    <input type="text" class="form-control col-md-8" name='AssetManagerApprovalComments' value="{{RequestObj.AssetMangerApprovalComments}}" >
                    {%else%}
                    {% comment %} <input type="text" class="form-control" name='AssetManagerApproval' readonly value="{{RequestObj.AssetManagerApproval}}" > {% endcomment %}
                    <input type="text" class="form-control" name='AssetManagerApprovalComments' readonly value="{{RequestObj.AssetMangerApprovalComments}}" >
                  {% endif %}
            </div>
            </div>
            {% comment %} <div class="col-md">
                <div class="input-group p-2 mb-3 text-center">
                    
                    <div class="input-group-prepend">
                      <span class="input-group-text">Supervisor</span>
                    </div>
                    <input type="text" class="form-control" name='SupApproval' readonly value="{{RequestObj.SupervisorApproval}}" >
                    {% if  request.user.staff.Username == RequestObj.Username.Manager.Username %}
                    <input type="text" class="form-control" name='SupervisorComments'  value="{{RequestObj.SupervisorApprovalComments}}" >
                    {% else %}
                    <input type="text" class="form-control" name='SupervisorComments' readonly value="{{RequestObj.SupervisorApprovalComments}}" >
                    
                    {% endif %}

            </div>
            </div> {% endcomment %}
            <div class="col-md">
                <div class="input-group p-2 mb-3 text-center">
                    <div class="input-group-prepend">
                      <span class="input-group-text">Accountant-AP</span>
                    </div>
                    <input type="text" class="form-control" name='FinanceManagerApproval' readonly value="{{RequestObj.FinanceManagerApproval}}" >
                    {% if  request.user.staff.staffrole == "Asset Manager" %}
                    <input type="textarea" rows="2" class="form-control" name='FinanceManagerApprovalComments' value="{{RequestObj.FinanceManagerApprovalComments}}" >
                    {% else %}
                    <input type="textarea" class="form-control" name='FinanceManagerApprovalComments' readonly value="{{RequestObj.FinanceManagerApprovalComments}}" >
                    {% endif %}
            </div>
            </div>

                <input type="Submit" value="Approve" name="approve" class="btn btn-primary btn-md mt-3">
                <input type="Submit" value="Reject" name="Reject" class="btn btn-danger btn-md mt-3">
                
          
            </form>  
        </div>
        </div>
        </div>

    </div>

</div>
</div>
</div>
</div>
</div>
</div>
</div>  



  {% endblock %}

  {% block scripts %}
  <script>
    $(function() {
      $("#Ast_tag_nbr_id").autocomplete({
          source: '{% url "get_asset" %}'
  
  });
  } );
  </script>

  {% endblock %}